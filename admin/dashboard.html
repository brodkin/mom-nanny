<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Nanny - Compassionate Care Dashboard</title>
  
  <!-- Preload critical resources -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link rel="preconnect" href="https://cdn.jsdelivr.net">
  
  <!-- CSS -->
  <link rel="stylesheet" href="css/admin.css">
  <link rel="stylesheet" href="css/global-search.css">
  
  <!-- Meta tags -->
  <meta name="description" content="Compassionate care dashboard for monitoring mental state and engagement">
  <meta name="theme-color" content="#6366f1">
  
  <!-- Favicon -->
  <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><rect width='100' height='100' rx='20' fill='%236366f1'/><g transform='translate(50,50) scale(1.5)'><path d='M12 2C8.5 2 6 4.5 6 7.5C6 8.2 6.1 8.9 6.3 9.5C5.8 9.3 5.3 9.2 4.8 9.2C3.8 9.2 3 10 3 11C3 12 3.8 12.8 4.8 12.8C5.3 12.8 5.8 12.7 6.3 12.5C6.5 12.8 6.8 13.1 7.1 13.3C7.5 13.6 8 13.8 8.5 13.9V14.5C8.5 15.3 9.2 16 10 16H14C14.8 16 15.5 15.3 15.5 14.5V13.9C16 13.8 16.5 13.6 16.9 13.3C17.2 13.1 17.5 12.8 17.7 12.5C18.2 12.7 18.7 12.8 19.2 12.8C20.2 12.8 21 12 21 11C21 10 20.2 9.2 19.2 9.2C18.7 9.2 18.2 9.3 17.7 9.5C17.9 8.9 18 8.2 18 7.5C18 4.5 15.5 2 12 2Z' fill='white'/><ellipse cx='12' cy='10' rx='4.5' ry='4' fill='%236366f1'/><path d='M9 14.5L10.5 15.5L12 15L13.5 15.5L15 14.5' stroke='white' stroke-width='0.5' fill='none'/><path d='M8 16C7.5 16 7 16.5 7 17V20C7 20.5 7.5 21 8 21H16C16.5 21 17 20.5 17 20V17C17 16.5 16.5 16 16 16' fill='white'/><path d='M10 17H14V20.5C14 20.8 13.8 21 13.5 21H10.5C10.2 21 10 20.8 10 20.5V17Z' fill='%236366f1'/><ellipse cx='6.5' cy='18' rx='1.5' ry='2.5' transform='rotate(-20 6.5 18)' fill='white'/><ellipse cx='17.5' cy='18' rx='1.5' ry='2.5' transform='rotate(20 17.5 18)' fill='white'/></g></svg>">
  
  <!-- Chart.js Library -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.js"></script>
  
  <!-- Prevent FOUC -->
  <style>
    body { visibility: hidden; }
    .js body { visibility: visible; }
    
    /* Loading States */
    .loading-skeleton {
      background: linear-gradient(90deg, var(--bg-secondary) 25%, var(--bg-tertiary) 50%, var(--bg-secondary) 75%);
      background-size: 200% 100%;
      animation: skeleton-loading 1.5s infinite;
    }
    
    @keyframes skeleton-loading {
      0% { background-position: 200% 0; }
      100% { background-position: -200% 0; }
    }
    
    .chart-loading {
      height: 300px;
      display: flex;
      align-items: center;
      justify-content: center;
      color: var(--text-secondary);
      font-size: 14px;
    }
    
    /* Dashboard-specific styles */
    .dashboard-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
      gap: var(--space-6);
      margin-bottom: var(--space-8);
    }
    
    .dashboard-row {
      display: grid;
      grid-template-columns: 2fr 1fr;
      gap: var(--space-6);
      margin-bottom: var(--space-6);
    }
    
    @media (max-width: 768px) {
      .dashboard-row {
        grid-template-columns: 1fr;
      }
      .dashboard-grid {
        grid-template-columns: 1fr;
      }
    }
    
    /* Mental State Indicators */
    .mental-state-indicator {
      display: flex;
      align-items: center;
      gap: var(--space-3);
      padding: var(--space-4);
      background: var(--bg-secondary);
      border-radius: var(--radius-lg);
      border: 1px solid var(--border-primary);
    }
    
    .mental-state-icon {
      width: 40px;
      height: 40px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 18px;
    }
    
    .mental-state-icon.calm { background: rgba(34, 197, 94, 0.1); color: rgb(34, 197, 94); }
    .mental-state-icon.elevated { background: rgba(251, 191, 36, 0.1); color: rgb(251, 191, 36); }
    .mental-state-icon.concerning { background: rgba(239, 68, 68, 0.1); color: rgb(239, 68, 68); }
    
    .mental-state-info h4 {
      margin: 0 0 var(--space-1);
      font-size: 14px;
      font-weight: 600;
      color: var(--text-primary);
    }
    
    .mental-state-info p {
      margin: 0;
      font-size: 13px;
      color: var(--text-secondary);
    }
    
    /* Care Indicators */
    .care-indicator {
      text-align: center;
      padding: var(--space-4);
    }
    
    .care-indicator-value {
      font-size: 2.5rem;
      font-weight: 700;
      color: var(--color-primary);
      margin-bottom: var(--space-2);
    }
    
    .care-indicator-label {
      font-size: 13px;
      color: var(--text-secondary);
      margin-bottom: var(--space-2);
    }
    
    .care-indicator-trend {
      font-size: 12px;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: var(--space-1);
    }
    
    .trend-up { color: rgb(34, 197, 94); }
    .trend-down { color: rgb(239, 68, 68); }
    .trend-stable { color: var(--text-secondary); }
    
    /* Alert System */
    .alert-item {
      display: flex;
      align-items: flex-start;
      gap: var(--space-3);
      padding: var(--space-4);
      border: 1px solid var(--border-primary);
      border-radius: var(--radius-lg);
      margin-bottom: var(--space-3);
    }
    
    .alert-item:last-child {
      margin-bottom: 0;
    }
    
    .alert-icon {
      width: 20px;
      height: 20px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      flex-shrink: 0;
      font-size: 12px;
    }
    
    .alert-icon.warning { background: rgba(251, 191, 36, 0.1); color: rgb(251, 191, 36); }
    .alert-icon.info { background: rgba(59, 130, 246, 0.1); color: rgb(59, 130, 246); }
    .alert-icon.success { background: rgba(34, 197, 94, 0.1); color: rgb(34, 197, 94); }
    
    .alert-content h5 {
      margin: 0 0 var(--space-1);
      font-size: 14px;
      font-weight: 600;
      color: var(--text-primary);
    }
    
    .alert-content p {
      margin: 0;
      font-size: 13px;
      color: var(--text-secondary);
    }
    
    .alert-time {
      font-size: 11px;
      color: var(--text-tertiary);
      margin-top: var(--space-1);
    }
    
    /* Chart containers */
    .chart-container {
      position: relative;
      height: 300px;
      margin: var(--space-4) 0;
    }
    
    .chart-container canvas {
      max-height: 100%;
    }
    
    /* Real-time status */
    .real-time-status {
      display: flex;
      align-items: center;
      gap: var(--space-2);
      font-size: 12px;
      color: var(--text-secondary);
    }
    
    .status-dot {
      width: 8px;
      height: 8px;
      border-radius: 50%;
      background: rgb(34, 197, 94);
      animation: pulse 2s infinite;
    }
    
    @keyframes pulse {
      0%, 100% { opacity: 1; }
      50% { opacity: 0.5; }
    }
  </style>
  <script>document.documentElement.className = 'js';</script>
</head>
<body>
  <!-- Admin Layout Container -->
  <div class="admin-layout">
    
    <!-- Sidebar -->
    <aside class="admin-sidebar custom-scrollbar" role="navigation" aria-label="Main navigation">
      <!-- Brand -->
      <div class="sidebar-brand">
        <div class="brand-logo" aria-label="Nanny Logo">
          <svg width="24" height="24" viewBox="0 0 24 24" fill="white" xmlns="http://www.w3.org/2000/svg">
            <!-- Hair bun and sides -->
            <circle cx="12" cy="6" r="4.5" fill="white"/>
            <circle cx="7" cy="8" r="2" fill="white"/>
            <circle cx="17" cy="8" r="2" fill="white"/>
            
            <!-- Face (negative space/cutout) -->
            <circle cx="12" cy="9.5" r="3.2" fill="var(--color-primary)"/>
            
            <!-- Collar -->
            <path d="M9 13L12 14L15 13" stroke="white" stroke-width="1" fill="none"/>
            
            <!-- Body/Uniform -->
            <rect x="8" y="14" width="8" height="8" rx="1" fill="white"/>
            
            <!-- Apron -->
            <rect x="10" y="15.5" width="4" height="6" rx="0.5" fill="var(--color-primary)"/>
            
            <!-- Arms -->
            <ellipse cx="6" cy="17" rx="1.2" ry="2.5" fill="white"/>
            <ellipse cx="18" cy="17" rx="1.2" ry="2.5" fill="white"/>
          </svg>
        </div>
        <div class="brand-text">Nanny</div>
      </div>

      <!-- Navigation Menu -->
      <nav class="nav-menu">
        <ul role="list">
          <li class="nav-item">
            <a href="/admin/dashboard" class="nav-link active">
              <svg class="nav-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"/>
              </svg>
              <span class="nav-text">Care Dashboard</span>
            </a>
          </li>
          
          <li class="nav-item">
            <a href="/admin/conversations" class="nav-link">
              <svg class="nav-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"/>
              </svg>
              <span class="nav-text">Conversations</span>
            </a>
          </li>
          
          <li class="nav-item">
            <a href="/admin/memories" class="nav-link">
              <svg class="nav-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"/>
              </svg>
              <span class="nav-text">Memories</span>
            </a>
          </li>
        </ul>
      </nav>
    </aside>

    <!-- Header -->
    <header class="admin-header" role="banner">
      <div class="header-left">
        <!-- Sidebar Toggle -->
        <button 
          id="sidebar-toggle" 
          class="sidebar-toggle btn-icon"
          aria-label="Toggle sidebar"
          data-tooltip="Toggle Sidebar (Ctrl+B)"
        >
          <svg width="20" height="20" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"/>
          </svg>
        </button>

        <!-- Breadcrumb -->
        <nav class="breadcrumb" aria-label="Breadcrumb">
          <div class="breadcrumb-item">
            <a href="index.html" class="breadcrumb-link">Home</a>
          </div>
          <div class="breadcrumb-item">
            <span class="breadcrumb-current">Compassionate Care Dashboard</span>
          </div>
        </nav>
      </div>

      <!-- Global Search Bar -->
      <div class="global-search-container">
        <div class="search-input-container">
          <input 
            type="text" 
            id="global-search-input" 
            class="form-input" 
            placeholder="Search conversations..."
            aria-label="Global search"
          >
          <svg class="search-icon" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <circle cx="11" cy="11" r="8"></circle>
            <path d="m21 21-4.35-4.35"></path>
          </svg>
        </div>
      </div>

      <div class="header-right">
        <!-- Real-time Status -->
        <div class="real-time-status" id="real-time-status">
          <div class="status-dot"></div>
          <span>Live monitoring active</span>
          <span id="last-update">Just now</span>
        </div>

        <!-- Theme Toggle -->
        <button 
          id="theme-toggle" 
          class="theme-toggle"
          aria-label="Toggle dark mode"
          data-tooltip="Toggle Theme (Ctrl+Shift+T)"
        >
          <!-- Sun Icon (for light mode) -->
          <svg class="theme-icon theme-icon-light" width="20" height="20" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"/>
          </svg>
          <!-- Moon Icon (for dark mode) -->
          <svg class="theme-icon theme-icon-dark" width="20" height="20" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"/>
          </svg>
        </button>

        <!-- User Profile -->
        <div class="user-profile dropdown">
          <div class="avatar avatar-md">
            <img src="https://images.unsplash.com/photo-1472099645785-5658abf4ff4e?w=40&h=40&fit=crop&crop=face" alt="Admin user" onerror="this.style.display='none'; this.nextElementSibling.style.display='flex';">
            <div style="display: none;">AD</div>
          </div>
          <div class="user-info">
            <div class="user-name">Caregiver Admin</div>
            <div class="user-role">Care Coordinator</div>
          </div>
          <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <polyline points="6,9 12,15 18,9"/>
          </svg>
        </div>
      </div>
    </header>

    <!-- Main Content -->
    <main class="admin-main" role="main">
      <!-- Welcome Section -->
      <section class="dashboard-welcome animate-fade-in">
        <div class="welcome-content">
          <h1 class="welcome-title">Compassionate Care Dashboard</h1>
          <p class="welcome-subtitle">
            Real-time insights into mental state, engagement patterns, and care indicators. 
            Every interaction is guided by patience, understanding, and dignity.
          </p>
        </div>
      </section>

      <!-- Mental State Overview -->
      <section class="content-section">
        <div class="section-header">
          <div>
            <h2 class="section-title">Mental State Monitoring</h2>
            <p class="section-subtitle">Current emotional well-being indicators</p>
          </div>
          <div class="section-actions">
            <button class="btn btn-ghost" onclick="dashboardReal.refreshMentalState()">
              <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"/>
              </svg>
              Refresh
            </button>
          </div>
        </div>

        <div class="dashboard-row">
          <div class="card">
            <div class="card-header">
              <h3 class="card-title">Mental State Trends</h3>
              <p class="card-subtitle">Anxiety, confusion, and agitation levels over time</p>
            </div>
            <div class="card-body">
              <div class="chart-container">
                <canvas id="mental-state-chart"></canvas>
                <div id="mental-state-loading" class="chart-loading">Loading mental state data...</div>
              </div>
            </div>
          </div>

          <div class="card">
            <div class="card-header">
              <h3 class="card-title">Current Status</h3>
              <p class="card-subtitle">Latest emotional indicators</p>
            </div>
            <div class="card-body">
              <div id="mental-state-indicators">
                <div class="mental-state-indicator loading-skeleton" style="height: 60px;"></div>
                <div class="mental-state-indicator loading-skeleton" style="height: 60px; margin-top: var(--space-3);"></div>
                <div class="mental-state-indicator loading-skeleton" style="height: 60px; margin-top: var(--space-3);"></div>
              </div>
            </div>
          </div>
        </div>
      </section>

      <!-- Care Indicators -->
      <section class="content-section">
        <div class="section-header">
          <div>
            <h2 class="section-title">Care Indicators</h2>
            <p class="section-subtitle">Health and care-related mentions</p>
          </div>
        </div>

        <div class="dashboard-row">
          <div class="card">
            <div class="card-header">
              <h3 class="card-title">Care Metrics Trends</h3>
              <p class="card-subtitle">Medication, pain, and hospital mentions over time</p>
            </div>
            <div class="card-body">
              <div class="chart-container">
                <canvas id="care-indicators-chart"></canvas>
                <div id="care-indicators-loading" class="chart-loading">Loading care indicators...</div>
              </div>
            </div>
          </div>

          <div class="card">
            <div class="card-header">
              <h3 class="card-title">Current Statistics</h3>
              <p class="card-subtitle">Recent care-related mentions</p>
            </div>
            <div class="card-body">
              <div class="stats-grid" id="care-indicators-stats">
                <div class="care-indicator loading-skeleton" style="height: 120px;"></div>
                <div class="care-indicator loading-skeleton" style="height: 120px;"></div>
                <div class="care-indicator loading-skeleton" style="height: 120px;"></div>
                <div class="care-indicator loading-skeleton" style="height: 120px;"></div>
              </div>
            </div>
          </div>
        </div>
      </section>

      <!-- Alert System -->
      <section class="content-section">
        <div class="section-header">
          <div>
            <h2 class="section-title">Alerts & Insights</h2>
            <p class="section-subtitle">Important insights and positive patterns</p>
          </div>
        </div>

        <div class="dashboard-row">
          <div class="card">
            <div class="card-header">
              <h3 class="card-title">Active Alerts</h3>
              <p class="card-subtitle">Items requiring attention</p>
            </div>
            <div class="card-body">
              <div id="active-alerts">
                <div class="alert-item loading-skeleton" style="height: 80px;"></div>
                <div class="alert-item loading-skeleton" style="height: 80px;"></div>
              </div>
            </div>
          </div>

          <div class="card">
            <div class="card-header">
              <h3 class="card-title">Positive Insights</h3>
              <p class="card-subtitle">Encouraging patterns and engagement</p>
            </div>
            <div class="card-body">
              <div id="positive-insights">
                <div class="alert-item loading-skeleton" style="height: 80px;"></div>
                <div class="alert-item loading-skeleton" style="height: 80px;"></div>
              </div>
            </div>
          </div>
        </div>
      </section>

      <!-- Conversation Analytics -->
      <section class="content-section">
        <div class="section-header">
          <div>
            <h2 class="section-title">Conversation Analytics</h2>
            <p class="section-subtitle">Call patterns and engagement insights</p>
          </div>
        </div>

        <div class="dashboard-grid">
          <div class="card">
            <div class="card-header">
              <h3 class="card-title">Daily Call Patterns</h3>
              <p class="card-subtitle">Call volume and duration trends</p>
            </div>
            <div class="card-body">
              <div class="chart-container">
                <canvas id="daily-patterns-chart"></canvas>
                <div id="daily-patterns-loading" class="chart-loading">Loading call pattern data...</div>
              </div>
            </div>
          </div>

          <div class="card">
            <div class="card-header">
              <h3 class="card-title">Hourly Distribution</h3>
              <p class="card-subtitle">Peak calling hours</p>
            </div>
            <div class="card-body">
              <div class="chart-container">
                <canvas id="hourly-distribution-chart"></canvas>
                <div id="hourly-distribution-loading" class="chart-loading">Loading hourly data...</div>
              </div>
            </div>
          </div>

          <div class="card">
            <div class="card-header">
              <h3 class="card-title">Feature Usage</h3>
              <p class="card-subtitle">AI function utilization</p>
            </div>
            <div class="card-body">
              <div class="chart-container">
                <canvas id="function-usage-chart"></canvas>
                <div id="function-usage-loading" class="chart-loading">Loading function data...</div>
              </div>
            </div>
          </div>
        </div>
      </section>
    </main>

    <!-- Footer -->
    <footer class="admin-footer" role="contentinfo">
      <div class="footer-left">
        <span>&copy; <span id="current-year">2025</span> Ryan Brodkin</span>
      </div>
      <div class="footer-right">
        <div class="status-indicator" id="system-heartbeat">
          <span class="status-dot" id="heartbeat-dot"></span>
          <span id="heartbeat-status">System Online</span>
        </div>
      </div>
    </footer>

    <!-- Mobile Sidebar Overlay -->
    <div class="layout-overlay"></div>
  </div>

  <!-- JavaScript -->
  <script src="js/admin.js"></script>
  <script type="module" src="js/global-search.js"></script>
  <script src="js/dashboard-real.js"></script>
</body>
</html>